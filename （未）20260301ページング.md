
```kernel.c
typedef unsigned int uint32_t;
uint32_t page_directory[1024] __attribute__((aligned(4096)));
uint32_t page_table0[1024]    __attribute__((aligned(4096)));
uint32_t page_table1[1024]    __attribute__((aligned(4096)));
#define PAGE_PRESENT 0x1
#define PAGE_RW      0x2

void paging_init()
{
    // --- 全PDEを無効 ---
    for (int i = 0; i < 1024; i++) {
        page_directory[i] = 0;
    }

    // --- page_table0 : 0～4MB 恒等 ---
    for (int i = 0; i < 1024; i++) {
        page_table0[i] = (i * 0x1000) | PAGE_PRESENT | PAGE_RW;
    }
    page_directory[0] = ((uint32_t)page_table0) | PAGE_PRESENT | PAGE_RW;

    // --- page_table1 : 実験用 ---
    for (int i = 0; i < 1024; i++) {
        page_table1[i] = 0;
    }

    // 仮想 0x400000 → 物理 0xB8000
    page_table1[0] = 0xB8000 | PAGE_PRESENT | PAGE_RW;
    page_directory[1] = ((uint32_t)page_table1) | PAGE_PRESENT | PAGE_RW;

    // --- CR3 ---
    asm volatile("mov %0, %%cr3" :: "r"(page_directory));

    // --- ページングON ---
    uint32_t cr0;
    asm volatile("mov %%cr0, %0" : "=r"(cr0));
    cr0 |= 0x80000000;
    asm volatile("mov %0, %%cr0" :: "r"(cr0));
}

void kernel_main() {
    
    paging_init();
    
    // 仮想アドレス
    volatile unsigned short* v = (unsigned short*)0x400000;

    v[0] = 0x0F41; // 'A'
    v[1] = 0x0F42; // 'B'
    v[2] = 0x0F43; // 'C'

    while(1);
}
```
